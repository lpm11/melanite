# -*- coding: utf-8 -*-
import sys;
import argparse;
import re;

def main():
    parser = argparse.ArgumentParser(description="melanite color scheme applier");
    parser.add_argument("--prefix", metavar="STR", help="prefix for replacement", default=r"@melanite-");
    parser.add_argument("--scheme", metavar="TSV", required=True, help="scheme tsv (generated by melanite-generate.py)");
    parser.add_argument("--exclude-sharp", action="store_true", help="exclude '#' prefix for color code");
    opt = parser.parse_args();

    d = dict(map(lambda c, v: ( c, v ), *zip(*map(lambda x: x.rstrip("\n").split("\t"), open(opt.scheme)))));
    if (opt.exclude_sharp):
        d = { c: v[1:] for c, v in d.items() };

    re_melanite = re.compile(re.escape(opt.prefix) + r"([\-\w]+)");
    for line in map(lambda line: line.rstrip("\n"), sys.stdin):
        line = re_melanite.sub(lambda m: d[m.group(1)], line);
        print(line);

    sys.exit(0);

if (__name__=="__main__"):
    main();
